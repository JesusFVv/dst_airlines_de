upstream jupyter {
    server jupyterlab-lea:8888;
}
upstream airflow {
    server s08938v0.snm.snecma:9876;
}
upstream egt_app {
    server s08938v0.snm.snecma:8889;
}
upstream strike_v2 {
    server s08938v0.snm.snecma:8620;
}
upstream wks_pred {
    server s08938v0.snm.snecma:8621;
}
upstream abaque_weibull {
    server s08938v0.snm.snecma:2828;
}
upstream mef_2p0{
    server s08938v0.snm.snecma:8500;
}
upstream jupyterlab_gaia_jean {
    server s12323e0.snm.snecma:9191;
}
upstream jupyterlab_gaia_aurelie {
    server s12323e0.snm.snecma:8894;
}
upstream jupyterlab_gaia_khalil {
    server s12323e0.snm.snecma:8896;
}
upstream jupyterlab_gaia_asven {
    server s12323e0.snm.snecma:8898;
}
upstream jupyterlab_gaia_jesus {
    server s12323e0.snm.snecma:8902;
}
upstream jupyterlab_gaia_taeheun {
    server s12323e0.snm.snecma:8904;
}
upstream jupyterlab_gaia_ilyes {
    server s12323e0.snm.snecma:8893;
}
upstream jupyterlab_gaia_atabak {
    server s12323e0.snm.snecma:8907;
}
upstream jupyterlab_gaia_anne_sophie {
    server s12323e0.snm.snecma:8901;
}
upstream jupyterlab_gaia_robin_yxfh {
    server s12324n0.snm.snecma:9193;
}
upstream jupyterlab_gaia_mathias {
    server s12323e0.snm.snecma:9192;
}

upstream jupyterlab_gaia_diego {
    server s12323e0.snm.snecma:8905;
}
upstream jupyterlab_gaia_dalia {
    server s12323e0.snm.snecma:8908;
}
upstream jupyterlab_gaia_alexandre {
    server s12323e0.snm.snecma:8897;
}
upstream jupyterlab_gaia_julien {
    server s12323e0.snm.snecma:8890;
}
upstream jupyter_server_jfv {
    server s12323e0.snm.snecma:8888;
}

proxy_set_header      Host $host;
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection "upgrade";
proxy_set_header   X-Real-IP            $remote_addr;
proxy_set_header   X-Forwarded-For      $proxy_add_x_forwarded_for;
proxy_set_header   X-Forwarded-Proto    $scheme;
proxy_set_header   X-Forwarded-User     $remote_user;
proxy_set_header   Authorization        $http_authorization;
proxy_set_header   X-ProxyScheme        $scheme;
proxy_set_header   X-ProxyHost          $hostname;
proxy_set_header   X-ProxyPort          $server_port;
proxy_set_header   X-ProxyContextPath   /;

# HTTP
server {
    listen 1033;
    server_name LEA;
    client_max_body_size 100M;
    
    ### airflow
    location ~ /airflow/(home)? {
        proxy_pass http://airflow;
        proxy_set_header Host $http_host;
        proxy_redirect off;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    ## abaque weibull
    #    location /abaque_weibull/ {
    #       proxy-pass http://shiny-server/abaque_weibull;
    #   }
    location /ollama/ {
        proxy_pass http://s12323e0.snm.snecma:11434/;
    }
}

# HTTPS
server {
    listen 443 ssl;
    server_name LEAS;
    client_max_body_size 100M;
    ssl_certificate /etc/nginx/ssl/s08938v0.snm.snecma.pem;
    ssl_certificate_key /etc/nginx/ssl/s08938v0.snm.snecma.key;	

### Ollama server
    location /ollama/ {
        proxy_pass http://s12323e0.snm.snecma:11434/;
    }
### elasticsearch
    location /elasticsearch/ {
        proxy_pass https://s08938v0.snm.snecma:9200/;
    }
    location /kibana {
        proxy_pass http://s08938v0.snm.snecma:5601;
    }
### jupyter
       location /jupjfv/ {
            proxy_pass https://jupyter_server_jfv;
        }
	location /jupyter/ {
	    proxy_pass https://jupyter/;
	}
	location ~ /jupyter/lab? {
	    proxy_pass https://jupyter;
	}
	location ~ /jupyter/api/ {
            proxy_pass https://jupyter;
    	}
	location ~ /jupyter/terminals/ {
            proxy_pass https://jupyter;
	}
	location ~ /jupyter/kernelspecs/ {
            proxy_pass https://jupyter;
	}
	location ~ /jupyter/static/ {
            proxy_pass https://jupyter;
	}
		
### egt_app 
    location /leap/ {
      	proxy_pass http://egt_app;
	}	
 
### abaque_weibull 
    location /abaque_weibull/ {
      	proxy_pass http://abaque_weibull;
	}
### strike_v2 
    location /strike_v2/ {
      	proxy_pass http://strike_v2;
	}		
### wkscp_pred
    location /wks_pred/ {
      	proxy_pass http://wks_pred;
	}		

### mef_2p0
    location /mef/ {
      	proxy_pass http://mef_2p0;
    }

### jupyterlab_gaia_jean
    location /s569921 {
        proxy_pass https://jupyterlab_gaia_jean;
    }

### jupyterlab_gaia_aurelie
    location ~ /s616447 {
        proxy_pass https://jupyterlab_gaia_aurelie;
    }

### jupyterlab_gaia_khalil
    location /s616723 {
        proxy_pass https://jupyterlab_gaia_khalil;
    }

### jupyterlab_gaia_asven
    location /s559349 {
	proxy_pass https://jupyterlab_gaia_asven;
    }
### jupyterlab_gaia_jesus
    location /s602590 {
        proxy_pass https://jupyterlab_gaia_jesus;
    }
### jupyterlab_gaia_taeheun
    location /s617006 {
        proxy_pass https://jupyterlab_gaia_taeheun;
    }
### jupyterlab_gaia_ilyes
    location /s629598 {
        proxy_pass https://jupyterlab_gaia_ilyes;
    } 
### jupyterlab_gaia_mathias
    location /s554102 {
        proxy_pass https://jupyterlab_gaia_mathias;
    } 
### jupyterlab_gaia_atabak
    location /s054058 {
        proxy_pass https://jupyterlab_gaia_atabak;
    }
### jupyterlab_gaia_robin_yxfh
    location /s580861 {
        proxy_pass https://jupyterlab_gaia_robin_yxfh;
    }
### jupyterlab_gaia_anne_sophie
    location /s053486 {
        proxy_pass https://jupyterlab_gaia_anne_sophie;
    }
### jupyterlab_gaia_diego
    location /s634040 {
	proxy_pass https://jupyterlab_gaia_diego;
    }
### jupyterlab_gaia_dalia
    location /s624498 {
        proxy_pass https://jupyterlab_gaia_dalia;
    }
### jupyterlab_gaia_alexandre
    location /s622856 {
        proxy_pass https://jupyterlab_gaia_alexandre;
    }	
### jupyterlab_gaia_julien
    location /s270633 {
        proxy_pass https://jupyterlab_gaia_julien;
    }

}
